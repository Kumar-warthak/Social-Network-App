using System;
using System.IO;
using Microsoft.SqlServer.Dts.Runtime;
using System.Windows.Forms;

public void Main()
{
    try
    {
        // Get the file path from the variable
        string filePath = Dts.Variables["User::SQLFilePath"].Value.ToString();

        // Read the file content
        string fileContent = File.ReadAllText(filePath);

        // Assign the file content to the variable
        Dts.Variables["User::SQLFileContent"].Value = fileContent;

        Dts.TaskResult = (int)ScriptResults.Success;
    }
    catch (Exception ex)
    {
        // Display the error message
        MessageBox.Show("Error reading SQL file: " + ex.Message);
        Dts.TaskResult = (int)ScriptResults.Failure;
    }
}


import requests
import urllib.parse

def fetch_via_proxy(proxy_url, target_url):
    # Encode the target URL to handle special characters
    encoded_target_url = urllib.parse.quote(target_url, safe=':/?#=@', encoding='utf-8')

    full_proxy_url = f"{proxy_url}/{encoded_target_url}"

    try:
        response = requests.get(full_proxy_url)

        if response.status_code == 200:
            print("Proxy response:", response.text)
        else:
            print("Error:", response.status_code)

    except requests.RequestException as e:
        print("Request Error:", e)

# Example usage
proxy_url = "http://proxy.example.com"
target_url = "http://username:password#@target.example.com#fragment"

fetch_via_proxy(proxy_url, target_url)
