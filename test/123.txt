public List<Dictionary<string, object>> GetSiteUsers(string siteId, string token, string proxyUrl = null)
{
    string url = $"https://graph.microsoft.com/v1.0/sites/{siteId}/users";
    var users = new List<Dictionary<string, object>>();
    var serializer = new JavaScriptSerializer();

    while (!string.IsNullOrEmpty(url))
    {
        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);
        request.Method = "GET";
        request.Headers.Add("Authorization", "Bearer " + token);

        if (!string.IsNullOrEmpty(proxyUrl))
            request.Proxy = new WebProxy(proxyUrl) { Credentials = CredentialCache.DefaultCredentials };

        using (WebResponse response = request.GetResponse())
        using (StreamReader reader = new StreamReader(response.GetResponseStream()))
        {
            string json = reader.ReadToEnd();
            var result = serializer.Deserialize<Dictionary<string, object>>(json);

            var valueList = (System.Collections.ArrayList)result["value"];
            foreach (var u in valueList)
                users.Add((Dictionary<string, object>)u);

            url = result.ContainsKey("@odata.nextLink") ? result["@odata.nextLink"].ToString() : null;
        }
    }

    return users;
}
