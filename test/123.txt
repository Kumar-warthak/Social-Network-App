from decimal import Decimal

def is_valid_numeric(val, precision, scale):
    try:
        d = Decimal(str(val).strip())
        int_digits = len(d.as_tuple().digits) - d.as_tuple().exponent
        return int_digits <= (precision - scale)
    except:
        return False

# Check all columns expected to be numeric
numeric_checks = {
    'col1': (5, 2),
    'col2': (10, 0),
}

for col, (precision, scale) in numeric_checks.items():
    invalid_rows = df[~df[col].apply(lambda x: is_valid_numeric(x, precision, scale))]
    if not invalid_rows.empty:
        print(f"\n❌ Problem in column '{col}':")
        print(invalid_rows[[col]])
