async function main(workbook: ExcelScript.Workbook, csvData: string, sheetName: string) {
    // Split CSV data into rows
    const rows = csvData.split('\n').map(row => row.split(','));

    // Create a new worksheet
    const newSheet = workbook.addWorksheet(sheetName);

    // Determine the maximum number of columns
    const maxColumns = Math.max(...rows.map(row => row.length));

    // Write data to the new worksheet
    newSheet.getRange("A1").getResizedRange(rows.length - 1, maxColumns - 1).setValues(rows);
}
