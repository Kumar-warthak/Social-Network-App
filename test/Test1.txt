from office365.sharepoint.client_context import ClientContext
from office365.runtime.auth.client_credential import ClientCredential

# Constants
SITE_URL = "https://yourtenant.sharepoint.com/sites/yoursite"
CLIENT_ID = "your-client-id"
CLIENT_SECRET = "your-client-secret"
LIST_NAME = "YourListName"

# Authenticate
def get_context(site_url, client_id, client_secret):
    credentials = ClientCredential(client_id, client_secret)
    ctx = ClientContext(site_url).with_credentials(credentials)
    return ctx

# Create a list item
def create_list_item(context, list_name, item_data):
    sp_list = context.web.lists.get_by_title(list_name)
    item = sp_list.add_item(item_data).execute_query()
    print(f"Item created successfully with ID: {item.properties['ID']}")

# Example Usage
if __name__ == "__main__":
    try:
        ctx = get_context(SITE_URL, CLIENT_ID, CLIENT_SECRET)
        data = {
            "Title": "New Item Title",  # Replace 'Title' with your column name
            "CustomColumn": "Value"    # Add other fields as required
        }
        create_list_item(ctx, LIST_NAME, data)
    except Exception as e:
        print("Error:", str(e))
