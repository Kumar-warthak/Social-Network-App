using System;
using System.IO;
using Microsoft.SqlServer.Dts.Runtime;

public void Main()
{
    // Folder containing the files
    string folderPath = @"C:\Path\To\Your\Folder";

    // Get all files in the folder
    string[] files = Directory.GetFiles(folderPath, "*.xls");

    foreach (string file in files)
    {
        try
        {
            // Define new file name with .csv extension
            string newFileName = Path.ChangeExtension(file, ".csv");
            
            // Rename the file
            File.Move(file, newFileName);
        }
        catch (Exception ex)
        {
            // Log any errors (customize as needed)
            Dts.Events.FireError(0, "Script Task", ex.Message, string.Empty, 0);
            Dts.TaskResult = (int)ScriptResults.Failure;
            return;
        }
    }

    Dts.TaskResult = (int)ScriptResults.Success;
}
