function main(workbook: ExcelScript.Workbook): void {
    let sheet = workbook.getActiveWorksheet();
    let headerRow = sheet.getRange("1:1").getValues()[0];  // Assumes headers are in the first row

    // Regular expression to match columns that start with "PushCode" and end with a number
    let regex = /^PushCode\d+$/;

    // Find all matching column indices
    let columnsToDelete = [];
    for (let i = 0; i < headerRow.length; i++) {
        if (regex.test(headerRow[i])) {
            columnsToDelete.push(i + 1);  // Store 1-based index for deletion
        }
    }

    // Delete columns in reverse order to avoid shifting issues
    for (let i = columnsToDelete.length - 1; i >= 0; i--) {
        sheet.getRange(1, columnsToDelete[i], 1, 1).getEntireColumn().delete(ExcelScript.DeleteShiftDirection.left);
    }
}
