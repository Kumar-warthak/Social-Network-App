function main(workbook: ExcelScript.Workbook, csvChunk: string, sheetName: string, startRow: number) {
  const rows = csvChunk.split("\n").map(row => row.split(","));

  // Access the existing worksheet
  const sheet = workbook.getWorksheet(sheetName);
  if (!sheet) {
    throw new Error(`The worksheet '${sheetName}' does not exist.`);
  }

  // Write the chunk to the worksheet starting from the specified row
  sheet.getRangeByIndexes(startRow, 0, rows.length, rows[0].length).setValues(rows);
}
