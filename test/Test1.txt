function main(workbook: ExcelScript.Workbook, sheetName: string): void {
    // Get the specified worksheet by name
    let sheet = workbook.getWorksheet(sheetName);
    if (!sheet) {
        console.log(`Sheet with name '${sheetName}' not found.`);
        return;
    }

    // Get the used range of the sheet
    let usedRange = sheet.getUsedRange();
    if (!usedRange) {
        console.log(`No data found in sheet '${sheetName}'.`);
        return;
    }

    // Get the values in the first row (header row)
    let headerRow = usedRange.getValues()[0];  // Get the first row from the used range

    // Check if the headerRow is empty
    if (headerRow.length === 0) {
        console.log(`Header row is empty in sheet '${sheetName}'.`);
        return;
    }

    // Regular expression to match columns that start with "PushCode" and end with a number
    let regex = /^PushCode\d+$/;

    // Explicitly declare columnsToDelete as an array of numbers
    let columnsToDelete: number[] = [];
    
    // Find all matching column indices
    for (let i = 0; i < headerRow.length; i++) {  // Loop through the first row values
        let columnName = headerRow[i] as string;  // Cast headerRow[i] to string
        if (regex.test(columnName)) {
            columnsToDelete.push(i + 1);  // Store 1-based index for deletion
        }
    }

    // Get the total number of rows in the used range
    let totalRows = usedRange.getRowCount();

    // Delete columns in reverse order to avoid shifting issues
    for (let i = columnsToDelete.length - 1; i >= 0; i--) {
        let columnToDelete = columnsToDelete[i];
        sheet.getRangeByIndexes(0, columnToDelete - 1, totalRows, 1).delete(ExcelScript.DeleteShiftDirection.left);
    }
}
