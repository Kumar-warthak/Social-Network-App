from office365.sharepoint.client_context import ClientContext
from office365.runtime.auth.authentication_context import AuthenticationContext

# Constants
SITE_URL = "https://yourtenant.sharepoint.com/sites/yoursite"
USERNAME = "your_email@yourtenant.onmicrosoft.com"
PASSWORD = "your_password"
LIST_NAME = "YourListName"

# Authenticate
def get_context(site_url, username, password):
    context_auth = AuthenticationContext(site_url)
    if context_auth.acquire_token_for_user(username, password):
        return ClientContext(site_url, context_auth)
    else:
        raise Exception("Authentication failed: " + context_auth.get_last_error())

# Create a list item
def create_list_item(context, list_name, item_data):
    sp_list = context.web.lists.get_by_title(list_name)
    item = sp_list.add_item(item_data).execute_query()
    print(f"Item created successfully with ID: {item.properties['ID']}")

# Example Usage
if __name__ == "__main__":
    try:
        ctx = get_context(SITE_URL, USERNAME, PASSWORD)
        data = {
            "Title": "New Item Title",  # Replace 'Title' with your column name
            "CustomColumn": "Value"    # Add other fields as required
        }
        create_list_item(ctx, LIST_NAME, data)
    except Exception as e:
        print("Error:", str(e))
